# axios 라이브러리 이용

npm install axios
- 이상의 명령어를 통해 axios 라이브러리 설치

엑시오스 라이브러리 사용을 위해서는 import문이 필수
```jsx
import axios from 'react';
```

axios 라이브러리에서는 JSON 데이터의 자동 변환과 같은 여러가지 이점이 있기 때문에 json()메서드가 필요하지 않다. 어제 배운 fetch 관련해서 코드를 axios로 작성시
```jsx
axios.get('http://someapi.com')
.then(response =>console.log(response))
.then(error => console.log(error));
```
비교
```js
fetch('http://someapi.com' , method: 'POST') 
.then(resonse => response.json())
.then(data => console.log(data))
.catch(error => console.log(error))
```

axios 라이브러리에서도 다양한 HTTP 메서드를 호출하는 전용 메서드가 존재

## POST 요청

- POST 요청을 하고 요청본문에 객체를 전송하려는 경우에는 axios.post()
```jsx
axios.post('http://someapi.com', {newObject})
.then(response => console.log(response))
.then(error => console.log(error))
```

axios() 함수를 이용하여 메서드, 헤더, 데이터, URL 등의 세부 정보를 저장하는 구성 객체를 전달하는것 또한 가능

```jsx
const response = await axios({
  method: 'POST',
  url: 'http://myapi.com/api/cars',
  headers: { 'Content-Type': 'application/json'},
  data: { brand: 'Ford' , model:'Ranger'},
});
```

- 이상의 예시 코드는 http://myapi.com/api/cars 엔드포인트로 POST요청을 보내고 요청본문에는 객체가 포함되며 Axios 는 이를 자동으로 데이터를 문자화 시킴

리액트 앱에서 REST API 를 이용하는 예시를 들 예정

OPEN WEATHER API를 이용 날씨를 가져와 컴포넌트에 렌더링 할 예정

OpenWeather API
http://openweathermap.org

회원가입 이후 로그인 진행 -> API keys 들어가서 default로 되어있는 apikey 이용

* 등록이 정상 처리된 후 10~15분 후 API 자동 활성화 된다 되어있지만 2시간까지 걸릴수 있음

이후 API 활용 리액트 프로젝트 생성

응답 데이터를 저장하는데 필요한 상태를 추가 예정 . 온도 / 설명 / 날씨 아이콘 표시할 예정

1. 온도상태/ 설명상태/ 날씨 아이콘 의 각각 상태를 만드는 방법
2. weather객체를 만든 후 거기에 property로 온도 설명 날씨아이콘 넣는 방법

https://api.openweathermap.org/data/2.5/weather?q=Seoul&units=Metric&APIkey=API값

이상의 사이트에서 json 데이터 분석했을 때 
desx -> description : console.log(weather[0].description /)
icon -> icon : console.log(weather[0].icon)
temp -> temp : console.log(main.temp)

이상의 json 데이터를 분석하여 console.log를 찍는다 가정했을 때
description, icon, temp의 정보를 가져오기 위한 주소지 찾기

MENU ={
  에스프레소:{
    "재료"{
      "물":100
      "커피":18
    },
    "가격":1.8
  }
}
라고 가정했을 때 가격 1.8을 출력하기 위해서는 
console.log(MENU["에스프레소"]["가격"])라고 설정해야함
npm install -g react-devtools

npx react-devtools

npm run dev 실행 후 연결 기다리기

react dev-tools 상에서 App 클릭시 temp desc icon 에 값이 들어가 있는거 확인 가능했음
temp desc icon 순으로 했지만 그 순서가 아닌 알파벳 순서로 정렬된것 확인 가능한데 객체의 key 가 순서입력하지 않아서 임

이상까지 확인 했을 경우 데이터를 가지고 온것 까지 완료 했으나
렌더링 되는 부분을 작성하지 않았음 이후 return문 작성

icon은 그림이여야 하는데 "01n"인것 확인됨
이미지 코드가 없어서 오류 발생 및 이미지 업로드 실패한걸로 보임

날씨 아이콘 추가를 위해 아이콘 확장자 추가해주는 작업 필요

아이콘 정보 관련
http://openseathermap.org/weather-conditions

- 이상의 예제에서 날씨 정보를 필요한 부분만 가지고 오는 연습 했음.
즉, API key 발급 받은 후 내부에 있는 JSON 데이터 참조한 뒤
필요한 날씨 설명, 아이콘, 기온을 가지고와서 useState를 통해 생성한 객체에 집어넣은 후 이를 출력할 수 있도록 코드를 작성함

해당 파트에서 낯선부분은 fetch와 관련된 부분인데 추후 더 설명 예정// 20250305.md파일 참조

## #2 Github API -> axios 사용 예정

### 타입스크립트 사용을 위해 프로젝트 생성
Github API URL :

https://api.github.com/search/repositories?q=react
https://api.github.com/search/repositories?q=키워드

로 들어가니 json파일 나오는데 
full_name / html_url 이용 예정.

```tsx
type Repository = {
  id:number;
  full_name:string;
  html_url:string;
}
//function
  const[keyword, setKeyword] =useState('');
  const[repodata, setRepodata] = useState<Repository[]>([])
```
사용자 입력 키워드를 이용하여 REST API 호출을 만들 예정. 입력 필드와 버튼을 구현해서 적용할 것

사용자가 입력 필드에 키워드 입력하고 버튼누르면 REST API가 호출되는 방식

사용자 입력에 대한 상태 및 JSON 응답의 데이터에 관한 상태 두가지를 만들고, 리포지토리 타입을 정의함

repository는 응답에서 JSON 배열로 반환되기 때문 repodata의 상태는 Repository타입의 배열이 됨. 요청을 보낼 때는 axios 사용 예정

```tsx
import axios from 'axios';
import { useState } from 'react';
import './App.css';

type Repository = {
  id:number;
  full_name:string;
  html_url:string;
}

function App() {
  const[keyword, setKeyword] =useState('');
  const[repodata, setRepodata] = useState<Repository[]>([])

  return (
    <>
    </>
  )
}
export default App

```
- 이상까지 입력한 후 return문에서 입력 필드와 버튼을 구현하고, 입력 필드에 onChange 관련 리스터를 추가하여 입력값을 keyword 상태에 저장할 수 있도록 해야함. 버튼에는 클릭 리스너가 있고, 주어진 키워드로 REST API를 호출하도록 함수를 작성할 예정

- return 완성 후 handleClick 로직을 작성할 예정인데 ``을 이용하여 url과 keyword 상태를 연결. 요청을 전송하기위해 axios.get()메서드 사용 예정. fetch와 다르게 .json()사용할 필요 없음

Axios는 자동으로 응답 데이터를 파싱한 다음 응답 데이터item 배열을 repodata상태에 저장 catch 사용하여 오류 처리 예정

그리고 타입스크립트 이용하고 있으므로 GET요청에서 예상되는 데이터 타입 정의하는 과정도 추가

응답이 items 속을 포함하는 객체라는 점을 확인, 그 다음 items의 속성의 value 값이 리포지토리 객체의 배열이라는 점도 볼 수 있었음

즉 데이터 타입은 {items: Repository[]}

이상의 정보를 응용하여 코드를 작성한다면 -> App.jsx

```tsx
  const handleClick = ()=>{
    axios.get<{items: Repository[]}>(`https://api.github.com/search/repositories?q=${keyword}`)
    .then(response => setRepodata(response.data.items))
    .catch(error => console.log(error));
  }
```

이상까지 코드를 작성하게 되면  repodata상태에 값이 저장이 됨
이상의 값을 브라우저에서 볼 수 있도록 return 수정 예정

map()을 이용하여 data상태를 테이블 행으로 변환 예정

repository의 url 속성은 (a)태그의 href 값이 되기 때문에 응용할 예정
또한 id 속성이 있어 고유 값으로 쓸 예정. 이를 테이블 행의 키로 사용 할 예정

해당 응답 결과가 리포지토리를 반환하지 않는 경우를 대비하여 조건부 렌더링으로 작성할 예정

```jsx
      <input 
      value={keyword} 
      onChange={e => setKeyword(e.target.value)}
      /> <br /><br /><br />
      <button onClick={handleClick}>Fetch</button>
      {repodata.length === 0 ? (
        <p>접근가능 데이터 없음</p>
    ):(
      <table>
        <tbody>
          {repodata.map(repo => (
            <tr key={repo.id}>
              <td>{repo.full_name}</td>
              <td>
                <a href={repo.html_url}>{repo.html_url}</a>
              </td>
            </tr>
          ))}
        </tbody>
      </table>
    )}
```

로 return문 추가

주의 사항 : 삼항 연산자 응용, 끝나는 시점을 확인하는 것이 쉽지 않음 

검색 결과가 없으면 repodata.length === 0  이기 때문에 표시할 정보가 없다고 나올 것이고 : 뒷부분에는 검색결과가 하나라도 있으면 table 형태로 보여줌